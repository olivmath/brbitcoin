
### 2. Blockchain Interaction

#### 2.1 Address Information

```rust
use brbitcoin::{Wallet, get_address_info};

let info = get_address_info("bc1q...", Network::Mainnet).unwrap();
println!("Balance: {} satoshis", info.balance);
println!("UTXOs: {}", info.utxos.len());

let wallet = Wallet::new(Network::Testnet).unwrap();
println!("Wallet balance: {} sats", wallet.balance().unwrap());
```

#### 2.2 Transaction Inspection

```rust
use brbitcoin::{Wallet, get_transaction};

let tx = get_transaction("aabb...", Network::Regtest).unwrap();
println!("Confirmations: {}", tx.confirmations);
for output in tx.outputs {
    println!("Output value: {}", output.value);
}

let wallet = Wallet::from_private_key("beef...", Network::Regtest).unwrap();
for utxo in wallet.utxos().unwrap() {
    println!("UTXO: {}:{} - {} sats", utxo.txid, utxo.vout, utxo.value);
}
```

#### 2.3 Block Exploration

```rust
use brbitcoin::get_block;

// By hash
let block = get_block("000000000019d6...", Network::Mainnet).unwrap();
println!("Block height: {}", block.height);

// By number
let genesis = get_block(0, Network::Mainnet).unwrap();
println!("Genesis timestamp: {}", genesis.timestamp);
```

### 3. Transaction Building

#### 3.1 High-Level (Recommended)

```rust
use brbitcoin::{Wallet, Fee};

const RECEIVER: &str = "tb123...";
const AMOUNT: f64 = 0.001; // BTC

let wallet = Wallet::new(Network::Regtest).unwrap();
let txid = wallet.send(RECEIVER, AMOUNT).unwrap();
println!("Broadcasted TX ID: {}", txid);
```

#### 3.2 Mid-Level Control

```rust
use brbitcoin::{Wallet, Transaction, to_satoshis};

const RECEIVER: &str = "tb123...";
const AMOUNT: u64 = 100_000; // Satoshis
const FEE: u64 = 500; // Satoshis

let wallet = Wallet::from_private_key("fff...", Network::Regtest).unwrap();
let utxos = wallet.utxos().unwrap();

let txid = Transaction::new(wallet.network())
    .add_input(&utxos[0])
    .add_output(RECEIVER, to_satoshis(AMOUNT))
    .fee(to_satoshis(FEE))
    .sign(&wallet)
    .broadcast()
    .unwrap();

println!("Broadcasted TX ID: {}", txid);
```

#### 3.3 Low-Level Scripting

```rust
use brbitcoin::{Wallet, Script, Transaction};

// Create a P2SH lock script
let lock_script = Script::new()
    .op_dup()
    .op_hash160()
    .push_bytes(&pubkey_hash)
    .op_equal_verify()
    .op_check_sig();

let wallet = Wallet::new(Network::Regtest).unwrap();
let utxos = wallet.utxos().unwrap();
const AMOUNT: f64 = 0.0001; // BTC

let txid = Transaction::new(Network::Regtest)
    .add_input(&utxos[0])
    .add_output_script(&lock_script, AMOUNT)
    .sign(&wallet)
    .broadcast()
    .unwrap();

println!("Broadcasted TX ID: {}", txid);
```

### 4. Taproot Transactions (BIP340/341/342)

#### 4.1 Generating Taproot Address

```rust
use brbitcoin::{Wallet, TaprootBuilder, Script};

let wallet = Wallet::new_random(Network::Mainnet).unwrap();
let internal_key = wallet.taproot_internal_key();

let script = Script::new()
    .op_hash160()
    .push_bytes(b"my_hash160")
    .op_equal();

let taproot = TaprootBuilder::new(internal_key)
    .add_leaf_script(&script)
    .finalize()
    .unwrap();

println!("Taproot Address: {}", taproot.address);
println!("Control Block: {}", hex::encode(taproot.control_block));
```

#### 4.2 Sending to Taproot Address

```rust
let wallet = Wallet::new(Network::Regtest).unwrap();
const RECEIVER_TAPROOT: &str = "bc1p...";

let txid = Transaction::new(Network::Regtest)
    .add_input(&wallet.utxos().unwrap()[0])
    .add_output_taproot(RECEIVER_TAPROOT, 0.01) // 0.01 BTC
    .set_change(&wallet.address())
    .estimate_fee()
    .sign(&wallet)
    .broadcast()
    .unwrap();

println!("Taproot TX broadcasted: {}", txid);
```

### 5. PSBT (Partially Signed Bitcoin Transaction)

#### 5.1 Creating a PSBT

```rust
use brbitcoin::{Wallet, Psbt};

let wallet = Wallet::new(Network::Testnet).unwrap();
let utxos = wallet.utxos().unwrap();

let psbt = Psbt::new()
    .add_input(&utxos[0])
    .add_output("tb1qrecipient...", 100_000) // 100,000 satoshis
    .estimate_fee()
    .build()
    .unwrap();

println!("PSBT created: {}", psbt.to_base64());
```

#### 5.2 Signing a PSBT

```rust
let wallet = Wallet::new(Network::Testnet).unwrap();
let signed_psbt = wallet.sign_psbt(&psbt).unwrap();

println!("Signed PSBT: {}", signed_psbt.to_base64());
```

#### 5.3 Broadcasting a PSBT

```rust
let txid = psbt.broadcast().unwrap();
println!("Transaction broadcasted: {}", txid);
```

---

### 6. Advanced Features

#### 6.1 Multi-Signature Wallets (n-of-m)

```rust
use brbitcoin::{MultisigWallet, Wallet};

let wallets: Vec<Wallet> = (0..3).map(|_| Wallet::new(Network::Testnet).unwrap()).collect();

let multisig = MultisigWallet::new(2, &wallets).unwrap();
println!("Multisig Address: {}", multisig.address());

// Sending funds
let psbt = multisig.create_transaction("tb1qrecipient...", 0.01).unwrap();
let signed_psbt = multisig.sign(&psbt).unwrap();
println!("Broadcast TX: {}", signed_psbt.broadcast().unwrap());
```

#### 6.2 Custom Scripts

```rust
use brbitcoin::{Wallet, Script};

let script = Script::new()
    .op_dup()
    .op_hash160()
    .push_bytes(b"custom_hash")
    .op_equal_verify()
    .op_check_sig();

println!("Custom Script Hex: {}", script.to_hex());
```

#### 6.3 Lightning Network Support (Experimental)

```rust
use brbitcoin::{LightningNode, PaymentRequest};

let node = LightningNode::new(Network::Testnet).unwrap();
node.connect("peer_address:port").unwrap();

let invoice = node.create_invoice(100_000, "Test Payment").unwrap(); // 100,000 satoshis
println!("Invoice: {}", invoice.to_string());

let payment = node.pay_invoice(&invoice).unwrap();
println!("Payment sent: {}", payment.payment_preimage);
```
